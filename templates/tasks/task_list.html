{% extends 'base.html' %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="mb-0">Ù…Ù‡Ø§Ù…ÙŠ</h2>
      <small class="text-muted">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ù…Ùƒ</small>
    </div>
    <a class="btn btn-cta" href="{% url 'tasks:task_create' %}">Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©</a>
  </div>

  <div class="dashboard-grid mb-4">
    <div class="glass-card">
      <div class="stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
      <div class="stat-value">{{ total_tasks }}</div>
    </div>
    <div class="glass-card">
      <div class="stat-title">Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
      <div class="stat-value">{{ completed_tasks }}</div>
    </div>
    <div class="glass-card">
      <div class="stat-title">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</div>
      <div class="stat-value">{{ pending_tasks }}</div>
    </div>
    <div class="glass-card">
      <div class="stat-title">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)</div>
      <div class="stat-value">{{ avg_duration_days }}</div>
    </div>
  </div>

  <div class="glass-card task-list">
    {% if tasks %}
      <div class="list-group">
        {% for task in tasks %}
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-3">
            <div class="task-icon">
              {% if task.icon_image %}
                <img src="{{ task.icon_image.url }}" alt="icon" style="width:100%;height:100%;border-radius:10px;object-fit:cover;"/>
              {% else %}
                {{ task.icon|default:"ğŸ“" }}
              {% endif %}
            </div>
            <div>
              <h5 class="mb-1">{{ task.title }}</h5>
              {% if task.description %}<p class="mb-1">{{ task.description }}</p>{% endif %}
              <small class="text-muted">Ø£Ù†Ø´Ø¦Øª: {{ task.created_at|date:"Y-m-d H:i" }} â€¢ Ø§Ù„Ø­Ø§Ù„Ø©: {% if task.completed %}Ù…ÙƒØªÙ…Ù„Ø©{% else %}Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°{% endif %}</small>
              <div><small class="text-muted">Ø§Ù„Ù…Ø¯Ø© Ù…Ù†Ø° Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: {{ task.created_at|timesince }}</small></div>
            </div>
          </div>
          <div class="btn-group">
            <a class="btn btn-sm btn-outline-secondary" href="{% url 'tasks:task_update' task.pk %}">ØªØ¹Ø¯ÙŠÙ„</a>
            <a class="btn btn-sm btn-outline-danger" href="{% url 'tasks:task_delete' task.pk %}">Ø­Ø°Ù</a>
            <a class="btn btn-sm btn-outline-success" href="{% url 'tasks:task_toggle' task.pk %}">{% if task.completed %}Ø¥Ù„ØºØ§Ø¡{% else %}Ø¥Ù†Ù‡Ø§Ø¡{% endif %}</a>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="p-3 text-center text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø¨Ø¹Ø¯. Ø£Ø¶Ù Ø£ÙˆÙ„ Ù…Ù‡Ù…Ø© Ø§Ù„Ø¢Ù†.</div>
    {% endif %}
  </div>

{% endblock %}
